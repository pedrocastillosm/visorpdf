<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Visor PDF</title>
  <script src="https://documentcloud.adobe.com/view-sdk/viewer.js"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100vh;
    }
    #adobe-dc-view {
      height: 100vh;
    }
  </style>
</head>
<body>
  <div id="adobe-dc-view"></div>

  <script>
    function getParameterByName(name) {
      name = name.replace(/[\[\]]/g, "\\$&");
      var url = window.location.href;
      var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
          results = regex.exec(url);
      if (!results) return null;
      if (!results[2]) return '';
      return decodeURIComponent(results[2].replace(/\+/g, " "));
    }

    document.addEventListener("DOMContentLoaded", function() {
      const codigoBase64 = getParameterByName('codigo');

      if (!codigoBase64) {
        document.body.innerHTML = "<h2>Falta par치metro 'codigo'</h2>";
        return;
      }

      let codigo = '';
      try {
        codigo = atob(codigoBase64);
      } catch (e) {
        document.body.innerHTML = "<h2>El par치metro 'codigo' no es v치lido (Base64 incorrecto)</h2>";
        return;
      }

      // Armar nombre de la pesta침a:
      const nombreArchivo = codigo.split('/').pop().replace('.pdf', '');
      document.title = `Blob | ${nombreArchivo}`;

      // Armar URL al Blob:
      const pdfUrl = `https://accesoexterno.blob.core.windows.net/verificardocumentos/${nombreArchivo}.pdf`;

      // Inicializar Adobe Embed:
      var adobeDCView = new AdobeDC.View({
        clientId: "9f988fee7e924fcba73ff232731fc3f5",
        divId: "adobe-dc-view"
      });
      adobeDCView.previewFile({
        content: { location: { url: pdfUrl } },
        metaData: { fileName: `${nombreArchivo}.pdf` }
      });
    });
  </script>
</body>
</html>